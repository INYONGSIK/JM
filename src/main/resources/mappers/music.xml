<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.ucamp.JM.dao.MusicDAO">
    <select id="selectAllMusic" resultType="Music">
        <![CDATA[select music_title, music_singer, music_genre,to_char(to_date(music_release,'YYYY/MM/DD')) as "music_release",
    music_like from music where rownum <= 10]]>
    </select>
    <insert id="insertAccumulMusic" parameterType="Music">
        insert into
        accumul(accumul_number,music_number,music_title,music_singer,music_genre,music_release,music_image,music_file,music_lyrics,music_like)
        values(accumul_seq.NEXTVAL,#{music_number},#{music_title},#{music_singer},TO_DATE(#{music_release},'YYYY/MM/DD'),#{music_release},#{music_image},#{music_file},#{music_lyrics},0)
    </insert>
    <insert id="insertTodayMusic" parameterType="Music">
        insert into today_music
        (today_music_number,rank_date,music_number,music_title,music_singer,music_genre,music_release,music_image,music_file,music_lyrics,music_like)
        values(today_music_seq.NEXTVAL,SYSDATE,#{music_number},#{music_title},#{music_singer},#{music_genre},#{music_release},#{music_image},#{music_file},#{music_lyrics},0)
    </insert>
    <update id="updateAccumulMusic" parameterType="AccumulMusic">
        update accumul set music_like = #{music_like} where music_number = #{music_number}
    </update>
    <update id="updateAccumulMusicLikeToZero">
        update accumul set music_like = 0
    </update>
    <insert id="insertMonthMusic" parameterType="AccumulMusic">
        insert into month_music
        (month_music_number,rank_date,music_number,music_title,music_singer,music_genre,music_release,music_image,music_file,music_lyrics,music_like)
        values
        (month_music_seq.NEXTVAL,SYSDATE,#{music_number},#{music_title},#{music_singer},#{music_genre},#{music_release},#{music_image},#{music_file},#{music_lyrics},#{accumul_music_like})
    </insert>
</mapper>
