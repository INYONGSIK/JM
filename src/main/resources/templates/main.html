<!DOCTYPE html>
<html lang="en" xmlns:th="www.thymeleaf.org">
<head>
    <meta charset="UTF-8"/>
    <title>Title</title>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
</head>
<link rel="stylesheet" href="/webapp/css/bootstrapLux.css"/>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.1/dist/js/bootstrap.bundle.min.js"></script>

<th:block th:replace="header :: header">

</th:block>

<body>


<div style="padding:50px;">
    <h1 style="text-align:center;">자음모임 MAIN</h1>
    <div style="position: absolute; right: 50px; top: 50px;">
        <th:block th:unless="${session.user_email}">
            <button type="button" class="btn btn-outline-light btn-sm" onclick="location.href='/loginform'">로그인</button>
            <button type="button" class="btn btn-outline-light btn-sm" onclick="location.href='/registerform'">회원가입</button>
        </th:block>

        <th:block th:if="${session.user_email}">
            <a href="/modifyinformationform">회원정보 수정</a>
            <a href="/logout">로그아웃</a>
        </th:block>
    </div>
    <!--현호 ==> 검색창-->
    <div class="form-group" style="text-align:center">
        <form action="/musicSearch" class="table-active" style="display:inline">

            <input type="text" class="form-control" placeholder="제목, 가수 검색" name="keyword"
                   style="width:40%;display:inline-block">
            <select name="genre" class="form-select" style="width:10%;display:inline-block">
                <option value="">전체</option>
                <option value="발라드">발라드</option>
                <option value="힙합">힙합</option>
                <option value="댄스">댄스</option>
                <option value="일레트로닉">일레트로닉</option>
                <option value="트로트">트로트</option>
                <option value="인디">인디</option>
                <option value="R&B">R&B</option>
                <option value="기타">기타</option>
            </select>
            <input type="submit" class="form-control" value="검색"
                   style="width:5%;display:inline-block">
        </form>
    </div>
    <!--grid 시작-->
    <div class="row">
        <!--top grid-->
        <div class="col-sm-4">
            <div class="card border-primary mb-3" style="margin:20px;">
                <div style="display:inline-block">
                    <h1 style="padding: 20px 30px; float:left;">TOP50</h1>
                    <button type="button" onclick="location.href='/rank'" class="btn btn-outline-primary"
                            style="max-width: 10rem;margin: 20px; float:right;">더보기
                    </button>
                </div>
                <div class="card-body">
                    <table class='table table-hover' style='width:100%' aria-describedby='example_info'>
                        <thead>
                        <tr class='table-active'>
                            <th class='sorting sorting_asc' tabindex='0' aria-controls='example' rowspan='1' colspan='1'
                                aria-sort='ascending'> 순위
                            </th>
                            <th class='sorting sorting_asc' tabindex='0' aria-controls='example' rowspan='1' colspan='1'
                                aria-sort='ascending'> 제목
                            </th>
                            <th class='sorting sorting_asc' tabindex='0' aria-controls='example' rowspan='1' colspan='1'
                                aria-sort='ascending'> 가수
                            </th>
                        </tr>
                        </thead>
                        <tbody id="mainRank">
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
        <!--dashboard grid-->
        <div class="col-sm-4">
            <div class="card border-primary mb-3" style="margin:20px;">
                <div style="display:inline-block">
                    <h1 style="padding: 20px 30px; float:left;">게시판</h1>
                    <button type="button" onclick="location.href='/boardList'" class="btn btn-outline-primary"
                            style="max-width: 10rem;margin: 20px; float:right;">더보기
                    </button>
                </div>
                <div class="card-body">
                    <table class='table table-hover' style='width:100%' aria-describedby='example_info'>
                        <thead>
                            <tr class='table-active'>
                                <th class='sorting sorting_asc' tabindex='0' aria-controls='example' rowspan='1' colspan='1'
                                    aria-sort='ascending'>No.
                                </th>
                                <th class='sorting sorting_asc' tabindex='0' aria-controls='example' rowspan='1' colspan='1'
                                    aria-sort='ascending'>제목
                                </th>
                                <th class='sorting sorting_asc' tabindex='0' aria-controls='example' rowspan='1' colspan='1'
                                    aria-sort='ascending'>작성자
                                </th>
                                <th class='sorting sorting_asc' tabindex='0' aria-controls='example' rowspan='1' colspan='1'
                                    aria-sort='ascending'>작성일자
                                </th>
                                <th class='sorting sorting_asc' tabindex='0' aria-controls='example' rowspan='1' colspan='1'
                                    aria-sort='ascending'>조회수
                                </th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr th:each="d:${dashboards}">
                                <td>[[${d.dashboard_No}]]</td>
                                <td><a th:href="|/readboard/${d.dashboard_No}|"> [[${d.dashboard_title}]] </a></td>
                                <td>[[${d.dashboard_user}]]</td>
                                <td>[[${d.dashboard_date}]]</td>
                                <td>[[${d.dashboard_views}]]</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
        <!--info grid-->
        <div class="col-sm-4">
            <div class="card border-primary mb-3" style="margin:20px;">
                <h1 style="padding: 20px 30px; display:inline">알림</h1>
                <div class="row">
                    <div class="col-sm-4">
                        <img src="">
                    </div>
                    <div class="col-sm-8">
                        <p>ooo님</p>
                        <p>[[${session.user_email}]]</p>
                        <p>알림</p>
                    </div>
                </div>
                <div class="card-body">
                    <div class="accordion" id="accordionExample">
                        <div class="accordion-item">
                            <h2 class="accordion-header" id="headingOne">
                                <button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapseOne" aria-expanded="true" aria-controls="collapseOne">
                                    Accordion Item #1
                                </button>
                            </h2>
                            <div id="collapseOne" class="accordion-collapse collapse show" aria-labelledby="headingOne" data-bs-parent="#accordionExample" style="">
                                <div class="accordion-body">
                                    알림
                                </div>
                            </div>
                        </div>
                        <div class="accordion-item">
                            <h2 class="accordion-header" id="headingTwo">
                                <button class="accordion-button collapsed" type="button" id="followerListBtn" th:value="${session.user_number}" data-bs-toggle="collapse" data-bs-target="#collapseTwo" aria-expanded="false" aria-controls="collapseTwo">
                                    팔로워
                                </button>
                            </h2>
                            <div id="collapseTwo" class="accordion-collapse collapse" aria-labelledby="headingTwo" data-bs-parent="#accordionExample" style="">
                                <div class="accordion-body" id="accordion-body">
                                    <table class='table table-hover' style='width:100%' aria-describedby='example_info'>
                                        <tbody id="followeeList">
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                        <div class="accordion-item">
                            <h2 class="accordion-header" id="headingThree">
                                <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseThree" aria-expanded="false" aria-controls="collapseThree">
                                    쪽지
                                </button>
                            </h2>
                            <div id="collapseThree" class="accordion-collapse collapse" aria-labelledby="headingThree" data-bs-parent="#accordionExample" style="">
                                <div class="accordion-body">
                                    쪽지
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <br>







            <br>
        <a href="/boardList">게시판</a>
        <th:block th:unless="${session.user_email}">
            <a href="/loginform">로그인</a></th:block>
        <a href="/registerform">회원가입</a>
        <a href="/modifyinformationform">회워정보 수정</a>
        <th:block th:if="${session.user_email}"><a href="/logout">로그아웃</a></th:block>


        <a href="/listPM">플레이리스트</a>
        <!--현호 ==> 검색창-->
        <form action="/musicSearch">
            <input type="text" name="keyword">
            <input type="submit" value="가수,제목 검색">
        </form>

        <div>
            <a href="/listPM">플레이리스트</a>
        </div>
        <a href="/listPM">플레이리스트</a>
        <a href="/mypage">마이페이지</a>
        <th:block th:if="${session.user_email}">
            <a href="/logout">로그아웃</a></th:block>
        <div id="content"></div>
    </div>

    <br><br>
    <div>
        <input type="text" id="msg"/>
        <button id="btnSend">Send Message</button>
        <div id="asd"></div>
    </div>
</div>
<script>
      $("#btnSend").on("click", function (evt) {
      evt.preventDefault();
    <!-- readyState == 1 이면 연결상태 , readyState == 3 이면 close 상태 -->
      if (socket.readyState != 1) return;
      let msg = $("input#msg").val();
      $("#asd").text(msg);
      socket.send(msg);
    });

</script>
<script src="/webapp/js/main.js"></script>
</body>
</html>
